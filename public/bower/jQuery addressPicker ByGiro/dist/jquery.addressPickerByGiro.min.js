var bg=bg||!1;bg||("undefined"!=typeof jQuery?bg=jQuery:"undefined"!=typeof angular&&(bg=angular.element,bg.extend=angular.extend)),function(e){"use strict";function t(e,t,n){clearTimeout(o[n]),o[n]=setTimeout(e,t)}function n(t){var n,a=this,t=t||this.addressMapping[this.$element.val()],i=!1;t||(i=!0);for(var r in this.settings.boundElements){var o=this.settings.boundElements[r],s="";if("function"!=typeof o){if(n=e(o),i||!(e(o).length<0)&&t.cleanData){i||(s="address_components"==r?JSON.stringify(t.cleanData):t.cleanData[r]);for(var d=n.length,g=0;d>g;g++){var l="val",p=n.eq(g);p.is("input, select, textarea")||(l="text"),p[l](s||"")}}}else s=o.call(a,t)}i||a.$element.triggerHandler("selected.addressPickerByGiro",t)}function a(){var t=this,n=e.extend({},t.settings.mapOptions);n.center=new google.maps.LatLng(n.center[0],n.center[1]);var a={position:n.center,draggable:!0,raiseOnDrag:!0,map:t.gmap,labelContent:t.settings.text.you_are_here,labelAnchor:new google.maps.Point(0,0),labelClass:t.settings.markerLabelClass,labelStyle:{opacity:1}};if("styled"==t.settings.markerType&&"function"==typeof StyledMarker){var i=new StyledIcon(StyledIconTypes.BUBBLE,{color:"#51A351",fore:"#ffffff",text:t.settings.text.you_are_here});a.styleIcon=i,t.gmarker=new StyledMarker(a)}else t.gmarker="labeled"==t.settings.markerType&&"function"==typeof MarkerWithLabel?new MarkerWithLabel(a):new google.maps.Marker(a);google.maps.event.addListener(t.gmarker,"dragend",function(){t.geocodeLookup(t.gmarker.getPosition(),!1,"latLng",!0)}),google.maps.event.addListener(t.gmap,"click",function(e){t.gmarker.setPosition(e.latLng),t.geocodeLookup(e.latLng,!1,"latLng",!0),t.resizeMap()}),this.gmarker.setVisible(!1)}function i(){var t,n=this,a=e.extend({},n.settings.mapOptions);a.center=new google.maps.LatLng(a.center[0],a.center[1]),t&&(t=1e3*t),t=t||n.settings.distanceWidgetRadius;var i=new google.maps.Circle({center:a.center,radius:t,strokeColor:"#005DE0",strokeOpacity:.8,strokeWeight:2,fillColor:"#005DE0",fillOpacity:.25,map:n.gmap}),r=function(){i.setEditable(!0)},o=function(){i.setEditable(!1)};n.gcircle=i,n.gcircle.setVisible(!1),google.maps.event.addListener(n.gcircle,"radius_changed",function(){n.updater()}),google.maps.event.addListener(n.gcircle,"mouseover",r),google.maps.event.addListener(n.gcircle,"mouseout",o),n.gcircle.bindTo("center",n.gmarker,"position")}var r,o={};r={init:function(t,n){var a=this;a.$element=t,a.settings=e.extend({},{style:"hidden",map:!1,mapId:!1,mapWidth:"100%",mapHeight:"300px",mapOptions:{zoom:3,center:[51.751724,-1.255284],scrollwheel:!1,mapTypeId:"roadmap"},makerType:!1,distanceWidget:!1,distanceWidgetRadius:3e4,appendToAddressString:"",geocoderOptions:{language:"en"},typeaheadOptions:{source:a.source,updater:a.updater,matcher:function(){return!0}},boundElements:{},text:{you_are_here:"You are here!"},map_rendered:!1},n);for(var i in a.settings.typeaheadOptions){var r=a.settings.typeaheadOptions[i];"function"==typeof r&&(a.settings.typeaheadOptions[i]=r.bind(a))}a.addressMapping={},a.currentItem="",a.geocoder=new google.maps.Geocoder,a.initMap.apply(a,void 0),"function"==typeof a.$element.typeahead&&a.$element.attr("autocomplete","off").typeahead(a.settings.typeaheadOptions),a.$element.parent().on("mouseenter focusin",function(e){"mouseenter"==e.type&&jQuery(this).addClass("mouseishover"),"hidden"==a.settings.style&&a.$mapContainer.show(),a.resizeMap()}).on("mouseleave focusout",function(e){"mouseleave"==e.type&&jQuery(this).removeClass("mouseishover"),jQuery(this).hasClass("mouseishover")||a.$element.is(":focus")||"hidden"==a.settings.style&&(a.geocodeLookup(a.$element.val(),!1,"",!0),a.$mapContainer.hide())}),""!=a.$element.val()&&a.geocodeLookup(a.$element.val(),!1,"",!0)},initMap:function(){var t=this;if(t.settings.mapId||t.settings.map instanceof google.maps.Map?t.$mapContainer=e(t.settings.mapId):(t.settings.mapId=(new Date).getTime()+Math.floor(9999999*Math.random()+1),t.$mapContainer=e('<div style="margin: 5px 0; width: '+t.settings.mapWidth+"; height: "+t.settings.mapHeight+';" id="'+t.settings.mapId+'"></div>'),t.$element.after(t.$mapContainer)),"hidden"==t.settings.style&&t.$mapContainer.hide(),1==t.map_rendered)return void t.resizeMap.call(t);var n=e.extend({},t.settings.mapOptions);this.settings.map instanceof google.maps.Map?this.gmap=this.settings.map:(n.center=new google.maps.LatLng(n.center[0],n.center[1]),this.gmap=new google.maps.Map(t.$mapContainer[0],n)),a.call(this),this.settings.distanceWidget&&i.call(this),t.map_rendered=!0},source:function(e,n){var a,i=this,r=function(r){t(function(){i.geocodeLookup(e,function(e){i.addressMapping={},a=[];for(var t=e.length,o=0;t>o&&9>o;o++){var s=e[o];i.addressMapping[s.formatted_address]=s,a.push(s.formatted_address)}return"function"==typeof r&&r(a),"function"==typeof n?n(a):void 0})},250,"source")};return window.Promise?new Promise(r):void r()},updater:function(e){var t,a=this,e=e||a.$element.val(),i=this.addressMapping[e]||{},r={},o=i.geometry.location;if(i){if(t={country:{long_name:"country",short_name:"country_code"},administrative_area_level_1:{long_name:"region",short_name:"region_code"},administrative_area_level_2:{long_name:"county",short_name:"county_code"},locality:{long_name:"city"},sublocality:{long_name:"city_district"},postal_code:{long_name:"zip"},route:{long_name:"street"},street_number:{long_name:"street_number"}},i.address_components)for(var s=0;s<i.address_components.length;s++){var d=i.address_components[s];for(var g in t)if(d.types.indexOf(g)>=0)for(var l in t[g])"undefined"!=typeof d[l]&&(r[t[g][l]]=d[l])}return r.latitude=Number(o.lat().toFixed(8)),r.longitude=Number(o.lng().toFixed(8)),r.formatted_address=i.formatted_address,a.gmarker&&(a.gmarker.setPosition(i.geometry.location),a.gmarker.setVisible(!0)),a.gcircle&&(a.gcircle.setCenter(i.geometry.location),a.gcircle.setVisible(!0),r.radius=Math.round(a.gcircle.getRadius())/1e3),a.gmap.fitBounds(a.gcircle?a.gcircle.getBounds():i.geometry.viewport),i.cleanData=r,n.call(a,i),e}},currentAddress:function(){return this.addressMapping[this.$element.val()]||{}},geocodeLookup:function(t,a,i,r){r=r||!1,i=i||"";var o=this,s=e.extend({},o.settings.geocoderOptions);if(r&&n.call(o),"latLng"==i)"string"==typeof t&&(t=t.split(","),t=new google.maps.LatLng(t[0],t[1])),s.latLng=t;else if(s.address=t+o.settings.appendToAddressString,"function"==typeof a&&"undefined"!=typeof o.addressMapping[t])return void(r&&o.updater(t));this.geocoder.geocode(s,function(e,t){if(t===google.maps.GeocoderStatus.OK&&("function"==typeof a&&a.call(o,e),r)){var n=e[0].formatted_address;o.$element.val(n),o.addressMapping[n]=e[0],o.updater(n)}})},resizeMap:function(n,a){var i=this;t(function(){var t,r=i.$mapContainer?i.$mapContainer.parent():e("#"+i.settings.mapId).parent();if(r.length){{var o=r.parent();o.height(),o.width()}t="undefined"!=typeof n&&"undefined"!=typeof a?new google.maps.LatLng(n,a):i.gmap.getCenter(),google.maps.event.trigger(i.gmap,"resize"),i.gmap.setCenter(t)}},300,"resize")},setRadius:function(e){var t=this;t.gcircle&&(t.gcircle.setRadius(1e3*e),t.gmap.fitBounds(t.gcircle.getBounds()))}};var s=function(t){var n=this.data("addressPickerByGiro");if(n)return"string"==typeof t&&n[t]?n[t].apply(n,Array.prototype.slice.call(arguments,1)):console.log("Method "+t+" does not exist on jQuery.addressPickerByGiro");if(!t||"object"==typeof t){for(var a=this.length,i=0;a>i;i++){var n,o=e(this[i]);n=e.extend({},r),n.init(o,t),o.data("addressPickerByGiro",n)}return this}return console.log('jQuery.addressPickerByGiro is not instantiated. Please call $("selector").addressPickerByGiro({options})')};e.fn?e.fn.addressPickerByGiro=s:e.prototype.addressPickerByGiro=s}(bg);